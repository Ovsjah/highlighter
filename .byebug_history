continue
highlight(copy[to_highlight[:start_word]...to_highlight[:end_word]], to_highlight[:comment])
continue
highlight(copy[to_highlight[:start_word]...to_highlight[:end_word]], to_highlight[:comment])
copy[to_highlight[:start_word]...to_highlight[:end_word]] == words[to_highlight[:start_word]...to_highlight[:end_word]]
words[to_highlight[:start_word]...to_highlight[:end_word]]
copy[to_highlight[:start_word]...to_highlight[:end_word]]
copy.size
words.size
continue
words.size
words
copy.size
to_highlight[:start_word]
copy[to_highlight[:start_word]...to_highlight[:end_word]]
copy[to_highlight[:start_word]]
continue
copy[to_highlight[:start_word]]
copy[to_highlight[:start_word]...to_highlight[:end_word]]
continue
words[366...368]
words[366]
words[287]
words[0]
words.size
words
continue
words.index('towelie.</p>')
words.index('towelie')
words.index('towelie.')
words.size
words
continue
highlight(words[to_highlight[:start_word]...to_highlight[:end_word]])
continue
highlight(words[to_highlight[:start_word]...to_highlight[:end_word]])
continue
highlight(words[to_highlight[:start_word]...to_highlight[:end_word]])
continue
color
continue
color
continue
color
continue
to_highlighted
continue
words[22..23].join.to_i(base=16)
words[22..23].join.to_i
words[22..23].join.hash.to_s(16).slice(2..5)
words[22..23].join.hash.to_s(16).slice(1..6)
words[22..23].join.hash.to_s(16).first(6)
words[22..23].join.hash.to_s(16)[1..6]
words[22..23].join.hash.to_s(16).slice(6)
words[22..23].join.hash.to_s(16).slice(1, 6)
words[22..23].join.hash.to_s(16)
words[22..23].join.hash.to_s(256)
words[22..23].join.hash.to_s(16)
words[22..23].join.hash.to_s
words[22..23].join.hash.to_s.sample
words[22..23].join.hash.slice(1..6)
words[22..23].join.hash.sample
words[22..23].join.hash.hex
words[22..23].join.hash
"ab,cdev;k;lm,asdfhajdslg".hex()
"ab,cdev;k;lm,asdfhajdslg".hex
'ab,cdev;k;lm,asdfhajdslg'.hex
'ab,c'.hex
words[22..23].join.hex
words[22..33].join.hex
words[22..55].join.hex
words[22..55].join.to_hex
words[22..55].join
words[22..55].hex
words[22..55]
words[22..55].join.hex
words[22..55].join(' ').hex
words[22..55].join(' ')
'abc'.hex
words[22..55].join.hex
words[22..55].join
words[22..55]
words.first
words
words_inside_paragraphs
words_inside_paragraphs.first
words_inside_paragraphs
'abc'.hex
to_highlighted
continue
to_highlighted
continue
to_highlighted
continue
to_highlighted
continue
to_highlighted
continue
words_inside_paragraphs
to_highlighted
continue
words_inside_paragraphs
to_highlighted
continue
to_highlighted
continue
paragraphs
words_inside_paragraphs.join(' ')
words_inside_paragraphs.first
words_inside_paragraphs
to_highlighted
continue
highlight(words_inside_paragraphs[hsh[:start_word]...hsh[:end_word]])
continue
highlight(words_inside_paragraphs[hsh[:start_word]...hsh[:end_word]])
continue
highlight(words_inside_paragraphs[hsh[:start_word]...hsh[:end_word]])
continue
to_highlighted
continue
words_inside_paragraphs
to_highlighted
words_inside_paragraphs
continue
words_inside_paragraphs
to_highlighted
continue
words_inside_paragraphs
paragraphs
to_highlighted
continue
paragraphs
paragrpaphs
to_highlighted
continue
to_highlighted
continue
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/, $~[:start] => '<span>', $~[:end] => '</span>')
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/, $[:start] => '<span>', $[:end] => '</span>')
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/, :start => '<span>', :end => '</span>')
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/, [:start] => '<span>', [:end] => '</span>')
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/, $~[:start] => '<span>', $~[:end] => '</span>')
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/, '<start>'=>'<span>', '<end>' => '</span>')
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/, '\k<start>'=>'<span>', '\k<end>' => '</span>')
spans
continue
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) do
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~[:end] = '</span>' }
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~[:end] => '</span>' }
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~[:end] }
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~[:start] }
highlighted.first.join(' ').gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/)
highlighted.first.join(' ').gsub do
highlighted.first.join(' ')
highlighted.first.join
highlighted.size
highlighted
continue
spans
continue
spans
continue
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) do "<span>" if $~[:start] </span> if $~[:end] e
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) do "<span>" if $~[:start] </span> if $~[:end] end
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) do "<span>" if $~[:start]; </span> if $~[:end] end
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { "<span>" if $~[:start]; </span> if $~[:end] }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { "<span>" if $~[:start]; (</span> if $~[:end]) }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { ("<span>" if $~[:start]); (</span> if $~[:end]) }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { (("<span>") if $~[:start]); (</span> if $~[:end]) }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p (("<span>") if $~[:start]); (</span> if $~[:end]) }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p ("<span>" if $~[:start]); (</span> if $~[:end]) }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p ("<span>" if $~[:start]); </span> if $~[:end] }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p "<span>" if $~[:start]; </span> if $~[:end] }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p "<span>" if $~[:start]; </span> if $~[:end];  }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p "<span>" if $~[:start]  }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~[:start] = "<span>"  }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~[:start] => "<span>"  }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~[:start] }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $[:start] }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $4 }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $3 }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $2 }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $1}
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/).methods
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/)
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p methods }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p :start }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p Match }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $ }
"<p>Abc".gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~ }
"<p>Abc".gsub(/(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>))/, '<span>')
"Abc".gsub(/(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>))/, '<span>')
"Abc".gsub(/(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>))/)
'<p>ABC'.gsub(/(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~ }
"Abc".gsub(/((^(?!<p>))?(?(1)^|(?<=<p>))|)/, '<span>')
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))/) { p $~ }
'<p>ABC'.gsub(/(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~ }
'<p>ABC'.gsub(/(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/, '</span>')
'<p>ABC'.gsub(/(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))
'<p>ABC'.gsub(/(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>))))
'<p>ABC'.gsub(/(?<end>(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/, '</span>')
'<p>ABC'.gsub(/(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>))/, '</span>')
'<p>ABC'.gsub(/(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/, '</span>')
'<p>ABC'.gsub(/(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~ }
'<p>ABC'.gsub(/(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)/) { p $~ }
'<p>ABC'.gsub(/(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>))/) { p $~ }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~ }
'<p>ABC'.gsub(/(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>))/, '</span>')
'<p>ABC'.gsub(/(?<e>(?<!<\/p>)$)?(?(e)$|(?=<\/p>))/, '</span>')
'<p>ABC'.gsub(/(?<e>(?<!<\/p>)$)?(?(<e>)$|(?=<\/p>))/, '</span>')
'<p>ABC'.gsub(/(?<e>(?<!<\/p>)$)?(?(<em>)$|(?=<\/p>))/, '</span>')
'<p>ABC'.gsub(/((?<!<\/p>)$)?(?(1)$|(?=<\/p>))/, '</span>')
'<p>ABC'.gsub(/((<?<!<\/p>)$)?(?(1)$|(?=<\/p>))/, '</span>')
'<p>ABC'.gsub(/(?(<?<!<\/p>)$)?(?(1)$|(?=<\/p>))/, '</span>')
'<p>ABC'.gsub(/(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>))/, '</span>')
'<p>ABC'.gsub(/(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>))/) { p $~ }
'<p>ABC'.gsub(/?<end>((<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>))/)
'<p>ABC'.gsub(/(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~ }
'<p>ABC'.gsub(/(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/)
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~ }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $ }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~[:end] }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { $~[:end] }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { $~[:start] ? '<span>' : '</span>' }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~[:start] }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~ }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $fuckyou }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $start }
'<p>ABC'.gsub(/((?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|((?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { $1 ? '<span>' : '</span>' }
'<p>ABC'.gsub(/((?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|((?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { $1 ? '<span>' : '</span>'}
'<p>ABC'.gsub(/((?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|((?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $4 }
'<p>ABC'.gsub(/((?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|((?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $3 }
'<p>ABC'.gsub(/((?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|((?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $2 }
'<p>ABC'.gsub(/((?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|((?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $1 }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $end }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $start }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $[:start] }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $~[:start] }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { $~[:start] }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { #{$~[:start]} }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p :start  }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p "\k<start>" }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(<e>)$|(?=<\/p>)))/) { p $1 }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(\k<s>)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(\k<e>)$|(?=<\/p>)))/) { p $1 }
'<p>ABC'.gsub(/(?<start>(?<s>^(?!<p>))?(?(1)^|(?<=<p>)))|(?<end>(?<e>(<?<!<\/p>)$)?(?(1)$|(?=<\/p>)))/) { p $1 }
'<p>ABC'.gsub(/(?<start>(^(?!<p>))?(?(1)^|(?<=<p>)))|(?<end>((?<!<\/p>)$)?(?(1)$|(?=<\/p>)))/) { p $1 }
'<p>ABC'.gsub(/((^(?!<p>))?(?(1)^|(?<=<p>)))|(((?<!<\/p>)$)?(?(1)$|(?=<\/p>)))/) { p $1 }
'<p>ABC'.gsub(/((^(?!<p>))?(?(1)^|(?<=<p>)))|(((?<!<\/p>)$)?(?(1)$|(?=<\/p>)))/) { p $2 }
'<p>ABC'.gsub(/(^(?!<p>))?(?(1)^|(?<=<p>))|((?<!<\/p>)$)?(?(1)$|(?=<\/p>))/) { p $2 }
'<p>ABC'.gsub(/(^(?!<p>))?(?(1)^|(?<=<p>))|((?<!<\/p>)$)?(?(1)$|(?=<\/p>))/) { p $1 }
'<p>ABC'.gsub(/(^(?!<p>))?(?(1)^|(?<=<p>))|((?<!<\/p>)$)?(?(1)$|(?=<\/p>))/) { $1 }
'<p>ABC'.gsub(/(^(?!<p>))?(?(1)^|(?<=<p>))|((?<!<\/p>)$)?(?(1)$|(?=<\/p>))/)
'<p>ABC'.gsub(/(?<s>^(?!<p>))?(?(\k<s>)^|(?<=<p>))|(?<ss>(?<!<\/p>)$)?(?(\k<ss>)$|(?=<\/p>))/)
'<p>ABC'.gsub(/(^(?!<p>))?(?(1)^|(?<=<p>))|((?<!<\/p>)$)?(?(1)$|(?=<\/p>))/)
'<p>ABC'.gsub(/(?<start>(^(?!<p>))?(?(1)^|(?<=<p>)))|(?<end>((?<!<\/p>)$)?(?(1)$|(?=<\/p>)))/) { p start }
'<p>ABC'.gsub(/(?<start>(^(?!<p>))?(?(1)^|(?<=<p>)))|(?<end>((?<!<\/p>)$)?(?(1)$|(?=<\/p>)))/) { p '<start>' }
